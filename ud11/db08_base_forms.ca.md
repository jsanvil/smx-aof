UD11: Bases de dades (I)

# 8. *LibreOffice Base*: Formularis simples. Manipulaci贸 de dades

##  Objectius

- Concepte de formulari.
- Con茅ixer els elements principals d'un formulari.
- Crear formularis senzills de manera automtica.
- Manipular dades des d'un formulari.
- Treballar i manipular camps de tipus objecte.

---

# 8.1 Formularis

*Base* ofereix, a m茅s de les taules i les consultes, un element molt potent per a gestionar la informaci贸 de les bases de dades: els formularis. En aquesta unitat aprendrem a crear formularis senzills amb els quals modificar les dades de manera visual i c貌moda, i aix铆 evitar l'edici贸 directa de les taules amb els problemes que aix貌 pot comportar.

**Els formularis s贸n objectes** que *Base* proporciona **per a veure, introduir o imprimir dades d'una o diverses taules**. Es tracta de la presentaci贸 de la informaci贸 continguda en les taules a trav茅s de la pantalla de l'ordinador amb un disseny intu茂tiu i agradable.

Per mitj dels formularis l'usuari visualitza la informaci贸 continguda en les taules, examina els resultats d'una consulta i altera el seu contingut introduint, modificant o eliminant informaci贸 en els camps. s a dir, ofereix les mateixes funcions de la Full de Dades o les Consultes aportant una millor presentaci贸 de cara a l'usuari final.

En definitiva, **les taules emmagatzemen la informaci贸 i els formularis s'encarreguen de recollir-la**. **En tancar o guardar els formularis, les taules s'actualitzen**.

# 8.2 Crear formularis amb l'auxiliar

L'Auxiliar per a crear formularis 茅s l'eina que ens facilita la creaci贸 de tota mena de formularis de la manera m茅s senzilla possible. Aix貌 no significa que l'Auxiliar per a formularis siga l'煤nica forma que podem utilitzar per a crear els formularis, per貌 s铆 la m茅s c貌moda i la que recomanem. Per a aix貌, l'assistent formula preguntes detallades sobre els or铆gens de registres, camps, disseny i format que desitgem i crega un formulari basat en les nostres respostes.

# 8.3 Formularis. Manipulaci贸 de dades

Despr茅s de crear un formulari i obrir-lo en pantalla podem intuir el fcil que resulta treballar amb ell. Doncs b茅, aquesta senzillesa 茅s una dels seus principals caracter铆stiques, les quals ens facilitaran molt la labor a l'hora de gestionar les dades. De fet, per a utilitzar un formulari n'hi ha prou amb usar els diferents camps que el componen per a afegir, modificar o visualitzar les dades de les nostres taules. En aquesta unitat aprendrem a manipular les dades mitjan莽ant formularis.

## 8.3.1 Elements del formulari

Quan obrim un formulari per a modificar les dades es mostrar una pantalla amb els seg眉ents elements:

- **Barra de Men煤s**. T茅 els mateixos men煤s que mostra el processador de textos *Writer, si b茅 茅s cert que dins d'ells apareixen algunes opcions espec铆fiques dels formularis.
- **Barra d'eines Estndard**. Igual que els men煤s, cont茅 els mateixos botons que observem quan estem escrivint qualsevol document en *Writer.
- **Barra d'eines Disseny de formularis**. Nom茅s es troba activa quan editem un formulari o quan el creguem en manera dissenye. Els seus diferents botons els veurem m茅s endavant.
- **Barra d'eines Navegaci贸 de formularis**. s la barra que tenim activa quan treballem amb les dades en un formulari qualsevol i en ella trobem botons per a moure'ns pels diferents registres, botons per a filtrar les dades del formulari, botons per a ordenar els registres per diferents camps, etc.
- **Barra d'Estat**. Ens ofereix tipus d'informaci贸 espec铆fica alhora que ens permet modificar determinats parmetres.

### 8.3.1.1 Barra navegaci贸 de formularis

Segons hem comentat anteriorment, un formulari ens permet interactuar amb la informaci贸 d'una taula per貌 de forma molt m茅s intu茂tiva i c貌moda. Tots els canvis que fem des d'un formulari s'aplicaran en la taula corresponent.

Base disposa d'una barra de navegaci贸 de formularis amb totes les funcions per a afegir, modificar o eliminar dades.

Els diferents botons d'aquesta barra no ens serveixen per a navegar pels camps que integren un formulari, sin贸 per a navegar pels diferents registres que utilitza aquest formulari. A continuaci贸 s'especifica quines accions realitzen alguns d'aquests botons:

- **Registre actual**: indica el n煤mero de registre en el qual ens trobem. Podem editar-lo per a anar directament a un determinat registre.
- **Total**: indica el nombre total de registres de la taula. Al principi indicar un n煤mero seguit d'un asterisc, el qual indicar que existeixen m茅s registres, encara que a mesura que anem passant cap avant, el n煤mero s'anir modificant fins a arribar al mxim real.
- **Moure's entre registres**: aquest conjunt de botons permet despla莽ar-nos entre els registres:

Bot贸 | Funci贸
-|-
| Despla莽ar-se al primer registre.
猬|Despla莽ar-se al registre anterior.
|Despla莽ar-se al registre posterior.
|Despla莽ar-se a l'煤ltim registre.

- **Inserir nou registre**: si fem clic sobre aquest bot贸 mostrar el formulari amb tots els camps buits i el cursor intermitent en el primer d'ells perqu猫 comencem a introduir les dades d'un nou registre.
- **Guardar canvis**: aquest bot贸 podem usar-lo per a guardar les dades que hgem introdu茂t en un registre nou o en un que estiguem modificant. Els registres tamb茅 es guarden automticament quan premem Entrar (Intro) estant en l'煤ltim camp del formulari. Hem de tindre en compte que per a guardar un registre no 茅s necessari emplenar tots els camps del formulari, bastar que emplenem aquells que siguen obligatoris.
- **Desfer 煤ltima acci贸**: aquest bot贸, igual que en qualsevol altra aplicaci贸, elimina els canvis que hgem realitzat, b茅 siga modificant dades o introduint dades noves en el registre actual. Aquesta opci贸 茅s vlida en l'edici贸 de dades.
- **Eliminar registre actual**: permet eliminar el contingut del registre que ens mostra el formulari. Aquesta acci贸 elimina les dades de la taula que els cont茅 i ja no podrem recuperar-los, per la qual cosa conv茅 tindre molt clar que volem esborrar les dades.

# 8.4 Modificaci贸 de dades en un formulari

La modificaci贸 de les dades d'un formulari es realitzar utilitzant la barra del punt anterior. Per a entendre-ho millor l'explicarem amb exemples.

## 8.4.1 Camp tipus Imatge

En cas que el formulari continga camps de tipus imatge, per a poder editar-la tenim 2 opcions:

- Fer doble clic.
- Fer clic amb el bot贸 dret del ratol铆 i seleccionar l'opci贸 `Insereix una imatge des de...`

#  *Activitat 9: Formularis*

**Crear formulari `FLIBRO`**

- Obri la base de dades `Biblioteca`.
- Fes clic en el bot贸 **Formularis** de la Barra de **Base de dades**.
En la zona superior de **Tasques**, fes clic en l'opci贸 `Crear un formulari utilizant l'auxiliar...`
- A continuaci贸 es desplegar un assistent que ens guiar pas a pas per a crear el nostre formulari.
- **Pas 1. Selecci贸 de camp**
  - Hem de triar quins camps volem que es mostren en el formulari i de quines taules. Les taules apareixeran en la part superior mentre que els camps es mostraran en la part inferior. Per a aix貌:
  - Selecciona la taula `LLIBRE`.
  - Selecciona tots els camps utilitzant els botons (un a un) o (tots).
  - Prem `Endavant >`

- **Pas 2. Configurar un subformulari**
  - Aquest pas es tractar en blocs posteriors de nivell m茅s avan莽at, per la qual cosa farem clic en `Endavant >`.

- **Pas 5. Organitzeu controls**
  - En el seg眉ent pas podem triar la distribuci贸 dels camps en el formulari.
  - Fes clic en la icona de l'esquerra "En columnes - Etiquetes a l'esquerra".
  - Prem `Endavant >`

- **Pas 6. Establir entrada de dades**
  - Deixem les opcions per defecte i premem `Endavant >`

- **Pas 7. Aplicar estils**
  - Ac铆 seleccionarem un dels estils proposats per Base.
  - Tria el color i els efectes 2D o 3D que vulgues.
  Prem `Endavant >`

- **Pas 8. Establir nom**
  - Finalment guardem el formulari.
  - En el camp Nom del formulari escriu *`FLIBRO`*. Deixa la resta d'opcions per defecte.
  - Fes clic a `Finalitza`

- Una vegada finalitzat l'assistent, se'ns obri el formulari per a introduir o modificar dades.
-  Guarda els canvis.

---

**Formulari `FLIBRO`. Afegir, esborrar i modificar dades**

- Fes clic en el bot贸 `Formularis` de la barra de `Base de dades`.
- Obri el formulari `FLIBRO` fent doble clic.
- Inserirem un nou llibre. Prem el bot贸 d'afegir registre de la barra navegaci贸 de formularis, que est situat en la part inferior de la pantalla.
- Ara els camps es fixaran a un valor buit i/o amb el seu valor per defecte.

> 锔 Les mscares de format aplicades als camps en les taules, no es transfereixen automticament als camps del formulari (per exemple en el camp d'any i preu). Posteriorment veurem com se soluciona aquest problema.

- Descrrega la seg眉ent imatge:
![](img/act_9_portada.jpg)
- Introdueix els valors del nou registre (si l'identificador ID de llibre ja existeix, introdueix un valor num猫ric de 10 o superior).

  - `ID`: 10
  - `ISBN`: 9788400000000
  - `Titol`: La 煤ltima legi贸n
  - `Cognoms_autor`: Massimo Manfredi
  - `Nom_autor`: Valerio
  - `Editorial`: SPQR
  - `Anyo`: 01/01/07
  - `Genere`: Historia
  - `Suport`: Paper
  - `Idioma`: Espanyol
  - `Preu`: 9,45
  - `Web`: <https://es.wikipedia.org/wiki/La_煤ltima_legi贸n>
  - `Portada`: [act_9_portada.jpg](img/act_9_portada.jpg)
- Inserir la imatge descarregada en el camp de la portada.
- Per a acabar, prem el bot贸 de guardar canvis perqu猫 aquests queden fixats en la taula.

---

**M茅s dades**

- Per a cadascun dels registres de la taula `LLIBRE`, descrrega d'Internet una imatge de la portada i afig aquesta imatge en el camp `Portada`. **Procura que les fotos no ocupen molt espai per a no superar el l铆mit de grandria a l'hora de pujar al portal la base de dades**.
-  Guarda els canvis.
- Tanca el formulari.

---

-  Guarda la base de dades.
- Tanca la base de dades.
- Lliura l'activitat.
